{"version":3,"sources":["components.jsx"],"names":["Page","React","Component","constructor","props","consumeParams","originalParams","location","search","substring","split","reduce","map","obj","key","value","match","showTip","clearQuery","replacement","length","history","replaceState","href","reloadPage","replace","render","ReactDOM","createElement","document","getElementById","HeaderTitle","divStyle","position","background","borderBottom","top","height","width","zIndex","h1Style","fontSize","fontFamily","margin","color","textShadow","cursor","imgStyle","icon","title","Overlay","left","pointerEvents","mode","children","LoginDialog","initialState","login","username","usernameConfirmed","email","emailConfirmed","password","password2","loggingIn","signupMessage","loginMessage","recoverySent","warning","passwordWeak","passwordMismatch","usernameTaken","emailExists","state","k","performLogin","bind","performResetPassword","signUp","loginUsernameBox","resetPasswordBox","loginPasswordBox","passwordChange","password2Change","submitForm","sendRecoveryLink","recover","checkUsernameAvailable","clear","setState","componentWillReceiveProps","nextProps","api","result","success","message","password_valid","session","user","onLogin","prevState","reset_password","resetPassword","changePassword","signupResult","check","prop","type","signup","loginChange","e","target","usernameChange","emailChange","getWarning","validPassword","test","invalidForm","validEmail","event","input","focus","display","profile_pic","backgroundImage","backgroundPositionX","profileX","backgroundPositionY","profileY","refs","password_field2","marginTop","loginSection","borderRadius","borderBottomLeftRadius","borderBottomRightRadius","alignItems","justifyContent","alignSelf","padding","recoverSection","onClickOut","signupSection","flexDirection","usernameInput","password_field","passwordConfirmed","transition","opacity","backgroundColor","toggle","overflow","PopDialog","Button","hidden","space","flex","pressed","backgroundPressed","disabled","borderLeft","leftMost","borderRight","rightMost","borderTopLeftRadius","borderTopRightRadius","onClick","fontColor","text","ButtonBar","index","buttons","list","property","array","LoginDialogHeader","MenuSwitcher","path","pathname","handleLogin","onModeChange","canUpdateHistory","onUrlChange","componentDidUpdate","prevProps","substr","pushState","componentDidMount","window","addEventListener","componentDidUnmount","removeEventListener","LoginMenu","url","open","close","loginDialog","callback","right","ProfileMenu","view","updateTime","refresh","logout","editProfile","handleClickOutside","profilePicUpdated","componentWillUnmount","node","wrapper","parentNode","Date","now","profileDialog","onLogout","minWidth","Tip","tip","ProfileDialog","cursorOnProfile","image","saving","old_password","canChangePassword","canSave","Image","onImageLoaded","profileSection","onFileUpload","onFileRead","onTouchProfile","onClickProfile","onMoveProfile","onSave","oldPasswordChange","lastMousePoint","x","y","canUpload","minSize","Math","min","naturalWidth","naturalHeight","scale","src","imageTooSmall","uploader","files","reader","FileReader","readAsDataURL","fileupload","click","clientX","clientY","movementX","movementY","max","stopPropagation","profilePicBinary","canvas","ctx","getContext","drawImage","toDataURL","save","invalid","warningMessage","marginLeft","marginBottom","blur"],"mappings":"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","file":"components.js","sourcesContent":["class Page extends React.Component {\n    constructor(props) {\n        super(props);\n        Page.consumeParams();\n    }\n\n    static consumeParams() {\n        Page.originalParams = location.search.substring(1).split(\"&\").reduce(\n            (map, obj) => {\n                const [,key, value] = obj.match(/^(\\w+)=([^?&]+|)$/) || [];\n                if(key) {\n                    map[key] = value;\n                }\n                return map;\n            }, {}\n        );\n    }\n\n    showTip() {}\n\n    static clearQuery(replacement) {\n        const search = replacement && replacement.length ? `?${replacement}` : '';\n        history.replaceState({},\n            'Dobuki',\n            `${location.href.split(\"?\")[0]}${search}`\n        );\n    }\n\n    static reloadPage() {\n        location.replace('');\n    }\n\n    static render() {\n        return ReactDOM.render(React.createElement(this, null), document.getElementById('root'));\n    }\n}\n\nclass HeaderTitle extends React.Component {\n    render() {\n        const divStyle = {\n            position: 'fixed',\n            background: 'linear-gradient(white, silver)',\n            borderBottom: '1px solid gray',\n            top: 0, height: 50, width: '100%', zIndex: 2,\n        };\n\n        const h1Style = {\n            fontSize: 32,\n            fontFamily: 'Fredoka One',\n            margin: 0,\n            color: '#012',\n            textShadow: '1px 1px 0 #FFF',\n            cursor: 'pointer',\n        };\n\n        const imgStyle = {\n            width: 50, height: 50,\n            cursor: 'pointer',\n        };\n\n        return (<div>\n            <div style={divStyle} className=\"header\">\n                <img style={imgStyle} src={this.props.icon} onClick={Page.reloadPage}/>\n                <h1 style={h1Style} onClick={Page.reloadPage}>{this.props.title}</h1>\n            </div>\n            <div style={{ height: 51 }}/>\n        </div>);\n    }\n}\n\nclass Overlay extends React.Component {\n    render() {\n        return <div style={{\n            position: 'absolute',\n            top: 51, left: 0,\n            width: '100%', height: 'auto',\n            pointerEvents: this.props.mode ? '' : 'none',\n        }}>\n            { this.props.children }\n        </div>\n    }\n}\n\nclass LoginDialog extends React.Component {\n    constructor(props) {\n        super(props);\n        this.initialState = {\n            login: null,\n            username: null,\n            usernameConfirmed: false,\n            email: null,\n            emailConfirmed: false,\n            password: null,\n            password2: null,\n            loggingIn: false,\n            signupMessage: null,\n            loginMessage: null,\n            recoverySent: false,\n            warning: null,\n            passwordWeak: null,\n            passwordMismatch: null,\n            usernameTaken: null,\n            emailExists: null,\n        };\n        this.state = {};\n        for (let k in this.initialState) {\n            this.state[k] = this.initialState[k];\n        }\n        if (this.props.mode === 'reset-password' && Page.originalParams.username) {\n            this.state.login = this.state.username = Page.originalParams.username;\n            this.state.usernameConfirmed = true;\n        }\n\n        this.performLogin = this.performLogin.bind(this);\n        this.performResetPassword = this.performResetPassword.bind(this);\n        this.signUp = this.signUp.bind(this);\n        this.loginUsernameBox = this.loginUsernameBox.bind(this);\n        this.resetPasswordBox = this.resetPasswordBox.bind(this);\n        this.loginPasswordBox = this.loginPasswordBox.bind(this);\n        this.passwordChange = this.passwordChange.bind(this);\n        this.password2Change = this.password2Change.bind(this);\n        this.submitForm = this.submitForm.bind(this);\n        this.sendRecoveryLink = this.sendRecoveryLink.bind(this);\n        this.recover = this.recover.bind(this);\n        this.checkUsernameAvailable = this.checkUsernameAvailable.bind(this);\n    }\n\n    clear() {\n        this.setState(this.initialState);\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if(this.props.mode !== nextProps.mode) {\n            this.setState({\n                password: null,\n                password2: null,\n            });\n        }\n    }\n\n    sendRecoveryLink() {\n        if (!this.state.loggingIn) {\n            this.setState({\n                loggingIn: true,\n                loginMessage: null,\n            });\n            api.recover(this.state.login, (result) => {\n                if(result.success) {\n                    this.setState({\n                        loggingIn: false,\n                        loginMessage: result.message,\n                        recoverySent: true,\n                    });\n                } else {\n                    this.setState({\n                        loggingIn: false,\n                        loginMessage: result.message,\n                    });\n                }\n            });\n        }\n    }\n\n    performLogin() {\n        if (!this.state.loggingIn) {\n            this.setState({\n                loggingIn: true,\n                loginMessage: null,\n            });\n            api.login(this.state.login, this.state.password || '', (result) => {\n                if(result.success) {\n                    if(result.password_valid) {\n                        session.user = result.username;\n                        this.props.onLogin();\n                    } else {\n                        this.setState((prevState) => {\n                            return {\n                                login: result.username,\n                                username: result.username,\n                                usernameConfirmed: true,\n                                loggingIn: false,\n                                loginMessage: '',\n                            };\n                        }, () => {\n                            if(result.reset_password) {\n                                this.props.resetPassword();\n                            }\n                        });\n                    }\n                } else {\n                    this.setState({\n                        loggingIn: false,\n                        loginMessage: result.message,\n                    });\n                }\n            });\n        }\n    }\n\n    performResetPassword() {\n        if (!this.state.loggingIn) {\n            this.setState({\n                loggingIn: true,\n                loginMessage: null,\n            });\n            api.changePassword(this.state.login, this.state.password || '', (result) => {\n                if(result.success) {\n                    session.user = result.username;\n                    this.props.onLogin();\n                } else {\n                    this.setState({\n                        loggingIn: false,\n                        loginMessage: result.message,\n                    });\n                }\n            });\n        }\n    }\n\n    signupResult(result) {\n        if (result.success) {\n            this.setState({\n                signupMessage: `\n                Thank you for signing up. Please check ${this.state.email}\n                for a confirmation email.\n            `,\n            });\n        } else {\n            this.setState({\n                loggingIn: false,\n                warning: result.message,\n            });\n        }\n    }\n\n    recover() {\n        this.setState({\n            login: null,\n            loginMessage: null,\n        }, function() {\n            this.props.recover();\n        }.bind(this));\n    }\n\n    checkUsernameAvailable(username) {\n        api.check(username, (result) => {\n            if(!result.success) {\n                const prop = result.type==='username' ? 'usernameTaken' : 'emailExists';\n                this.setState({\n                    [prop]: result.message,\n                });\n            }\n        });\n    }\n\n    signUp() {\n        if (!this.state.loggingIn) {\n            this.setState({\n                loggingIn: true,\n                signupMessage: null,\n            });\n            api.signup(\n                this.state.username,\n                this.state.email,\n                this.state.password,\n                this.signupResult.bind(this),\n            );\n        }\n    }\n\n    loginChange(e) {\n        const target = e.target;\n        this.setState({\n            login: target.value,\n        });\n    }\n\n    usernameChange(e) {\n        const target = e.target;\n        this.setState((prevState) => {\n            return {\n                usernameTaken: null,\n                username: target.value,\n            }\n        });\n    }\n\n    emailChange(e) {\n        const target = e.target;\n        this.setState((prevState) => {\n            return {\n                emailExists: null,\n                email: target.value,\n            };\n        });\n    }\n\n    getWarning() {\n        if (this.state.loggingIn) {\n            return null;\n        }\n        return this.state.warning\n            || this.state.passwordMismatch\n            || this.state.passwordWeak\n            || this.state.emailExists\n            || this.state.usernameTaken;\n    }\n\n    passwordChange(e) {\n        const target = e.target;\n        this.setState((prevState) => {\n            return {\n                passwordWeak: !LoginDialog.validPassword(target.value)\n                    ? \"Your password must have at least eight characters, including one letter and one number.\"\n                    : null,\n                password: target.value,\n            };\n        });\n    }\n\n    password2Change(e) {\n        const target = e.target;\n        this.setState((prevState) => {\n            return {\n                passwordMismatch: prevState.password !== target.value\n                    ? \"The passwords you entered must match.\" : null,\n                password2: target.value,\n            };\n        });\n    }\n    \n    static validPassword(password) {\n        return /^(?=.*[A-Za-z])(?=.*\\d).{8,}$/.test(password);\n    }\n\n    static invalidForm(state) {\n        return !state.username\n            || !this.validEmail(state.email)\n            || !this.validPassword(state.password)\n            || state.password2 !== state.password\n            || state.usernameTaken\n            || state.emailExists;\n    }\n\n    submitForm(event) {\n        if(event.key === 'Enter'){\n            if (this.props.mode==='reset_password') {\n                this.performResetPassword();\n            } else {\n                this.performLogin();\n            }\n        }\n    }\n\n    loginUsernameBox() {\n        return [\n            <div style={{ height: 20 }}/>,\n            <input ref={input => input && input.focus()}\n                   type=\"text\"\n                   placeholder=\"Enter your username or email\"\n                   className=\"input\"\n                   onChange={this.loginChange.bind(this)}\n                   disabled={this.state.loggingIn}\n                   value={this.state.login}\n                   onKeyPress={this.submitForm}\n                   style={{\n                       height: 40,\n                       width: '100%',\n                   }}/>,\n            <div style={{ height: 20 }}/>,\n            <div style={{\n                display: 'flex',\n                height: 50,\n                width: '70%',\n            }}>\n                <Button text=\"next\"\n                        leftMost rightMost\n                        onClick={this.performLogin}\n                        fontSize=\"24\"\n                        fontColor=\"#eee\"\n                        background={\"linear-gradient(#59f79d, #2c6846)\"}\n                        backgroundPressed=\"#a3e2bf\"\n                        pressed={this.state.loggingIn}\n                        disabled={!this.state.login}\n                />\n            </div>,\n        ];\n    }\n\n    profile_pic() {\n        return `/profile-picture/${this.state.username}/image.png`;\n    }\n\n    loginPasswordBox() {\n        const fontFamily = \"'Concert One', cursive\";\n        return [\n            <div style={{ height: 20 }}/>,\n            <div ref=\"profile_pic\" className=\"profile-pic\"\n                 style={{\n                     backgroundImage: `url(${this.profile_pic()})`,\n                     backgroundPositionX: this.state.profileX,\n                     backgroundPositionY: this.state.profileY,\n                 }}/>,\n            <div style={{\n                    fontFamily,\n                    fontSize: 20,\n                    height: 40,\n                    display: this.state.usernameConfirmed ? '' : 'none',\n                }}\n                onClick={() => {\n                    this.setState({\n                        usernameConfirmed: false,\n                        password: null,\n                    });\n                }}>{ this.state.username }</div>,\n            <input type=\"text\"\n               value={this.state.login} readonly autocomplete=\"off\"\n               style={{ display: 'none' }}\n            />,\n            <input ref={input => input && input.focus()}\n                type=\"password\"\n                placeholder=\"Enter your password\"\n                className=\"input\"\n                onChange={this.passwordChange.bind(this)}\n                disabled={this.state.loggingIn}\n                value={this.state.password}\n                onKeyPress={this.submitForm}\n                style={{\n                    height: 40,\n                    width: '100%',\n                }}/>,\n            <div style={{ height: 20 }}/>,\n            <div style={{\n                display: 'flex',\n                height: 50,\n                width: '70%',\n            }}>\n                <Button\n                    text=\"login\"\n                    leftMost rightMost\n                    onClick={this.performLogin}\n                    fontSize=\"24\"\n                    fontColor=\"#eee\"\n                    background={\"linear-gradient(#59f79d, #2c6846)\"}\n                    backgroundPressed=\"#a3e2bf\"\n                    pressed={this.state.loggingIn}\n                    disabled={!this.state.password}\n                />\n            </div>,\n        ];\n    }\n\n    resetPasswordBox() {\n        const fontFamily = \"'Concert One', cursive\";\n        return [\n            <div style={{ height: 20 }}/>,\n            <div style={{\n                fontFamily,\n                fontSize: 20,\n                height: 40,\n                display: this.state.usernameConfirmed ? '' : 'none',\n            }}\n                 onClick={() => { this.setState({ usernameConfirmed: false }); }}\n            >{ this.state.username }</div>,\n            <input type=\"text\" value={this.state.login} readonly autocomplete=\"off\"\n               style={{ display: 'none' }}\n            />,\n            <input\n               type=\"password\"\n               placeholder=\"Enter a new password\"\n               className=\"input\"\n               onChange={this.passwordChange.bind(this)}\n               disabled={this.state.loggingIn}\n               value={this.state.password}\n               onKeyPress={(event) => {\n                   if(event.key === 'Enter'){\n                       this.refs.password_field2.focus();\n                   }\n               }}\n               style={{\n                   height: 40,\n                   width: '100%',\n               }}/>,\n            <div style={{ height: 10 }}/>,\n            <input ref=\"password_field2\"\n               type=\"password\"\n               placeholder=\"Re-enter the same password\"\n               className=\"input\"\n               onChange={this.password2Change.bind(this)}\n               disabled={this.state.loggingIn}\n               value={this.state.password2}\n               onKeyPress={(event) => {\n                   if(!this.constructor.invalidForm(this.state)) {\n                       this.submitForm(event);\n                   }\n               }}\n               style={{\n                   height: 40,\n                   width: '100%',\n               }}/>,\n            <div style={{ height: 20 }}/>,\n            <div style={{\n                display: 'flex',\n                height: 50,\n                width: '70%',\n            }}>\n                <Button\n                    text=\"Change password\"\n                    leftMost rightMost\n                    onClick={this.performResetPassword}\n                    fontSize=\"24\"\n                    fontColor=\"#eee\"\n                    background={\"linear-gradient(#59f79d, #2c6846)\"}\n                    backgroundPressed=\"#a3e2bf\"\n                    pressed={this.state.loggingIn}\n                    disabled={\n                        !LoginDialog.validPassword(this.state.password)\n                        || this.state.password2 !== this.state.password\n                    }\n                />\n            </div>,\n            <div style={{\n                color: '#D00',\n                marginTop: 15,\n            }}>{this.getWarning()}</div>,\n        ];\n    }\n\n    loginSection() {\n        const borderRadius = 8;\n        const fontFamily = \"'Concert One', cursive\";\n        return (<div style={{\n            width: '100%',\n            height: 'auto',\n            borderBottomLeftRadius: borderRadius,\n            borderBottomRightRadius: borderRadius,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n        }}>\n            <div className=\"loginsection\">\n                {\n                    this.props.mode === 'reset-password' && this.state.username && this.state.usernameConfirmed\n                    ? this.resetPasswordBox()\n                    : this.state.usernameConfirmed\n                    ? this.loginPasswordBox()\n                    : this.loginUsernameBox()\n                }\n                <div style={{\n                    display: 'flex',\n                    marginTop: 20,\n                    alignItems: 'center', alignSelf: 'center', justifyContent: 'center',\n                    width: 50, height: 50,\n                }}>\n                    <div className={\n                        `tux-loading-indicator ${this.state.loggingIn?'show':''}`\n                    }>\n                    </div>\n                </div>\n                { this.state.loginMessage &&  <div style={{\n                        fontFamily,\n                        fontSize: 20,\n                        padding: 20,\n                    }}>\n                        { this.state.loginMessage }\n                    </div>\n                }\n                { !this.state.loggingIn && this.props.mode!=='reset-password' &&\n                    <div><a className=\"link\" onClick={this.recover}>\n                        Did you forget your password?\n                    </a></div>\n                }\n            </div>\n        </div>);\n    }\n\n    recoverSection() {\n        const borderRadius = 8;\n        const fontFamily = \"'Concert One', cursive\";\n        return (<div style={{\n            width: '100%',\n            height: 'auto',\n            borderBottomLeftRadius: borderRadius,\n            borderBottomRightRadius: borderRadius,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n        }}>\n            <div className=\"loginsection\">\n                <div style={{ height: 20 }}/>\n                <input ref={input => input && input.focus()}\n                   type=\"email\"\n                   placeholder=\"Enter your email\"\n                   className=\"input\"\n                   onChange={this.loginChange.bind(this)}\n                   disabled={this.state.loggingIn || this.state.recoverySent}\n                   value={this.state.login}\n                   onKeyPress={this.submitForm}\n                   style={{\n                       height: 40,\n                       width: '100%',\n                   }}/>,\n                <div style={{ height: 20 }}/>\n                <div style={{\n                    display: 'flex',\n                    height: 50,\n                    width: '70%',\n                }}>\n                    <Button text=\"send recovery link\"\n                        leftMost rightMost\n                        onClick={this.sendRecoveryLink}\n                        fontSize=\"24\"\n                        fontColor=\"#eee\"\n                        background={\"linear-gradient(#59f79d, #2c6846)\"}\n                        backgroundPressed=\"#a3e2bf\"\n                        pressed={this.state.loggingIn || this.state.recoverySent}\n                        disabled={!this.state.login || !LoginDialog.validEmail(this.state.login)}\n                    />\n                </div>\n                <div style={{\n                    display: 'flex',\n                    marginTop: 20,\n                    alignItems: 'center', alignSelf: 'center', justifyContent: 'center',\n                    'width': 50, 'height': 50,\n                }}>\n                    <div className={\n                        `tux-loading-indicator ${this.state.loggingIn?'show':''}`\n                    }>\n                    </div>\n                </div>\n                { this.state.loginMessage &&  <div style={{\n                    fontFamily,\n                    fontSize: 20,\n                    padding: 20,\n                }}>\n                    { this.state.loginMessage }\n                </div>\n                }\n                <div style={{\n                    display: 'flex',\n                    height: 50,\n                    width: '70%',\n                }}>\n                { this.state.recoverySent &&\n                    <Button text=\"close\"\n                        leftMost rightMost\n                        onClick={this.props.onClickOut}\n                        fontSize=\"24\"\n                        fontColor=\"#eee\"\n                        background={\"linear-gradient(#59f79d, #2c6846)\"}\n                        backgroundPressed=\"#a3e2bf\"\n                    />\n                }\n                </div>\n\n            </div>\n        </div>);\n    }\n\n    static validEmail(email) {\n        return /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/.test(email);\n    }\n\n    signupSection() {\n        const borderRadius = 8;\n        const fontFamily = \"'Concert One', cursive\";\n        return (this.state.signupMessage ?\n            <div style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'center',\n            }}>\n                <div style={{\n                    fontFamily,\n                    fontSize: 20,\n                    padding: 20,\n                }}>\n                    { this.state.signupMessage }\n                </div>\n                <div style={{\n                    display: 'flex',\n                    height: 50,\n                    width: '70%',\n                }}>\n                    <Button text=\"close\"\n                        leftMost rightMost\n                        onClick={this.props.onClickOut}\n                        fontSize=\"24\"\n                        fontColor=\"#eee\"\n                        background={\"linear-gradient(#59f79d, #2c6846)\"}\n                        backgroundPressed=\"#a3e2bf\"\n                    />\n                </div>\n            </div> :\n            <div style={{\n                width: '100%',\n                height: 'auto',\n                borderBottomLeftRadius: borderRadius,\n                borderBottomRightRadius: borderRadius,\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n            }}>\n            <div className=\"loginsection\">\n                <div style={{ height: 20 }}/>\n                <input\n                    ref={(input) => { this.usernameInput = input; input && input.focus(); }}\n                    placeholder=\"Enter a username\"\n                    className=\"input\"\n                    onChange={this.usernameChange.bind(this)}\n                    onBlur={() => { this.setState((prevState) => {\n                        this.checkUsernameAvailable(prevState.username);\n                        return { usernameConfirmed: prevState.username }});\n                    }}\n                    disabled={this.state.loggingIn}\n                    value={this.state.username}\n                    onKeyPress={(event) => {\n                        if(event.key === 'Enter'){\n                            this.refs.email.focus();\n                        }\n                    }}\n                    style={{\n                        height: 40,\n                        width: '100%',\n                        display: this.state.usernameConfirmed ? 'none' : '',\n                    }}/>\n                <div\n                    className=\"confirmed-input\"\n                    style={{\n                        display: this.state.usernameConfirmed ? '' : 'none',\n                    }}\n                     onClick={() => {\n                         this.setState({ usernameConfirmed: false }, () => {\n                             this.usernameInput.focus();\n                         });\n                     }}\n                ><div><b>Username:</b> { this.state.username }</div></div>\n                <div style={{ height: 20 }}/>\n                <input ref=\"email\" type=\"email\"\n                    placeholder=\"Enter an email\"\n                    className=\"input\"\n                    onChange={this.emailChange.bind(this)}\n                    onBlur={() => {this.setState((prevState) => {\n                        this.checkUsernameAvailable(prevState.email);\n                        return { emailConfirmed:\n                            this.constructor.validEmail(prevState.email) ? prevState.email : null\n                        }});\n                    }}\n                    disabled={this.state.loggingIn}\n                    value={this.state.email}\n                       onKeyPress={(event) => {\n                           if(event.key === 'Enter'){\n                               this.refs.password_field.focus();\n                           }\n                       }}\n                    style={{\n                        height: 40,\n                        width: '100%',\n                        display: this.state.emailConfirmed ? 'none' : '',\n                    }}/>\n                <div\n                    className=\"confirmed-input\"\n                    style={{\n                        display: this.state.emailConfirmed ? '' : 'none',\n                    }}\n                     onClick={() => {\n                         this.setState({ emailConfirmed: false }, () => {\n                             this.usernameInput.focus();\n                         });\n                     }}\n                ><div><b>Email:</b> { this.state.email }</div></div>\n                <div style={{ height: 20 }}/>\n                <input ref=\"password_field\" type=\"password\"\n                    placeholder=\"Enter a password\"\n                    className=\"input\"\n                    onChange={this.passwordChange.bind(this)}\n                    onBlur={() => { this.setState({ passwordConfirmed: true }); }}\n                    onFocus={() => { this.setState({ passwordConfirmed: false }); }}\n                    disabled={this.state.loggingIn}\n                    value={this.state.password}\n                    onKeyPress={(event) => {\n                       if(event.key === 'Enter'){\n                           this.refs.password_field2.focus();\n                       }\n                    }}\n                    style={{\n                        height: 40,\n                        width: '100%',\n                        color: this.state.passwordConfirmed && this.state.password !== this.state.password2 ?\n                           'red' : 'black'\n                    }}/>\n                <div style={{ height: 20 }}/>\n                <input ref=\"password_field2\" type=\"password\"\n                       placeholder=\"Retype password\"\n                       className=\"input\"\n                       onChange={this.password2Change.bind(this)}\n                       disabled={this.state.loggingIn}\n                       value={this.state.password2}\n                       onKeyPress={(event) => {\n                           if(event.key === 'Enter'){\n                               this.signUp();\n                           }\n                       }}\n                       style={{\n                           height: 40,\n                           width: '100%',\n                       }}/>\n                {!this.state.loggingIn && [\n                    <div style={{ height: 20 }}/>,\n                    <div style={{\n                        display: 'flex',\n                        height: 50,\n                        width: '70%',\n                    }}>\n                        <Button\n                            text=\"sign up\"\n                            leftMost rightMost\n                            onClick={this.signUp}\n                            fontSize=\"24\"\n                            fontColor=\"#eee\"\n                            background={\"linear-gradient(#59f79d, #2c6846)\"}\n                            backgroundPressed=\"#a3e2bf\"\n                            pressed={this.state.loggingIn}\n                            disabled={this.constructor.invalidForm(this.state)}\n                        >\n                            <i right/>\n                        </Button>\n                    </div>\n                ]}\n                <div style={{\n                    color: '#D00',\n                    marginTop: 15,\n                }}>{this.getWarning()}</div>\n                <div style={{\n                    display: 'flex',\n                    marginTop: 20,\n                    alignItems: 'center', alignSelf: 'center', justifyContent: 'center',\n                    'width': 50, 'height': 50,\n                }}>\n                    <div className={\n                        `tux-loading-indicator ${this.state.loggingIn?'show':''}`\n                    }>\n                    </div>\n                </div>\n            </div>\n        </div>);\n    }\n\n    render() {\n        return (\n            <div>\n                <Overlay mode={this.props.mode}>\n                { this.props.mode &&\n                    <div className=\"overlay\">\n                        <div style={{\n                            position: 'fixed',\n                            top: 0, left: 0,\n                            width: '100%', height: 'calc(100% + 200px)',\n                            transition: 'opacity .2s linear',\n                            opacity: this.props.mode ? .8: 0,\n                            backgroundColor: '#002',\n                            cursor: 'pointer',\n                            display: this.props.mode ? '' : 'none',\n                        }} onClick={this.props.onClickOut}>\n                        </div>\n                        <div className=\"popdialog\">\n                            <LoginDialogHeader toggle={this.props.toggle} mode={this.props.mode}/>\n                            <div style={{ width: '100%', overflow: 'hidden' }}>\n                                { this.props.mode==='login' && this.loginSection() }\n                                { this.props.mode==='reset-password' && this.loginSection() }\n                                { this.props.mode==='signup' && this.signupSection() }\n                                { this.props.mode==='recover' && this.recoverSection() }\n                            </div>\n                        </div>\n                    </div>\n                }\n                </Overlay>\n            </div>\n        );\n    }\n}\n\nclass PopDialog extends React.Component {\n    render() {\n\n    }\n}\n\nclass Button extends React.Component {\n    render() {\n        const borderRadius = 8;\n        const fontFamily = \"'Concert One', cursive\";\n        return (!this.props.hidden && <div style={{\n            margin: this.props.space ? \"0 5px\" : null,\n            flex: 1,\n            transition: '.2s',\n            background: this.props.pressed\n                ? this.props.backgroundPressed || '#444466'\n                : this.props.disabled\n                ? 'linear-gradient(white, silver)'\n                : this.props.background || 'linear-gradient(white, gray)',\n            borderLeft: this.props.leftMost ? 0 : '1px solid gray',\n            borderRight: this.props.rightMost ? 0 : '1px solid gray',\n            borderTopLeftRadius: this.props.leftMost ? borderRadius : 0,\n            borderBottomLeftRadius: this.props.leftMost ? borderRadius : 0,\n            borderTopRightRadius: this.props.rightMost ? borderRadius : 0,\n            borderBottomRightRadius: this.props.rightMost ? borderRadius : 0,\n            fontFamily,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            cursor: 'pointer',\n            pointerEvents: this.props.pressed ? 'none' : '',\n        }} onClick={this.props.disabled?null:this.props.onClick}>\n            <div style={{\n                fontSize: this.props.fontSize || 20,\n                color: this.props.pressed ? 'snow'\n                    : this.props.disabled ? 'silver'\n                    : this.props.fontColor || '#666677',\n            }}>\n                {this.props.text}\n            </div>\n        </div>);\n    }\n}\n\nclass ButtonBar extends React.Component {\n    constructor(props) {\n        super(props);\n        this.onClick = this.onClick.bind(this);\n    }\n\n    onClick(index) {\n        this.props.onClick(index);\n    }\n\n    render() {\n        const buttons = this.props.list.map((property, index, array) => {\n            const prop = typeof(property)==='string' ? { text:property } : property;\n            return (\n                <Button\n                    pressed={this.props.pressed===index}\n                    onClick={prop.onClick ? prop.onClick : () => { this.onClick(index); }}\n                    text={prop.text}\n                    leftMost={index===0}\n                    rightMost={index===array.length-1}\n                />\n            )\n        });\n        return (<div style={{\n            display: 'flex',\n            height: 50,\n            width: 'calc(100% - 100px)',\n        }}>\n            { buttons }\n        </div>);\n    }\n}\n\nclass LoginDialogHeader extends React.Component {\n    render() {\n        const borderRadius = 8;\n        const fontFamily = \"'Concert One', cursive\";\n        return <div style={{\n            width: '100%',\n            height: 100,\n            borderTopLeftRadius: borderRadius,\n            borderTopRightRadius: borderRadius,\n            background: 'linear-gradient(white, silver)',\n            borderBottom: '1px solid gray',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n        }}>\n            {this.props.mode === 'recover' ? <div style={{\n                fontFamily,\n                padding: 50,\n            }}>\n                Please enter your email. We will send you a link to reset your password.\n            </div>:\n            <ButtonBar list={[ 'login', 'signup' ]} onClick={this.props.toggle}\n               pressed={this.props.mode==='login' || this.props.mode==='reset-password' ? 0 : 1}\n            />}\n        </div>\n    }\n}\n\nclass MenuSwitcher extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            username: session.user,\n            path: location.pathname,\n        };\n        this.handleLogin = this.handleLogin.bind(this);\n        this.onModeChange = this.onModeChange.bind(this);\n        this.canUpdateHistory = true;\n        this.onUrlChange = this.onUrlChange.bind(this);\n    }\n\n    handleLogin() {\n        this.setState({\n            username: session.user,\n        });\n    }\n\n    onModeChange(mode) {\n        this.setState({\n            path: `/${mode || ''}`,\n        });\n    }\n\n    onUrlChange() {\n        if (location.pathname !== this.state.path) {\n            this.canUpdateHistory = false;\n            this.setState({\n                path: location.pathname,\n            });\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.path !== this.state.path) {\n            if (!this.canUpdateHistory) {\n                this.canUpdateHistory = true;\n            } else {\n                const mode = this.state.path.substr(1);\n                history.pushState({mode}, mode || 'Dobuki', this.state.path);\n            }\n        }\n    }\n\n    componentDidMount() {\n        window.addEventListener('popstate', this.onUrlChange);\n    }\n\n    componentDidUnmount() {\n        window.removeEventListener('popstate', this.onUrlChange);\n    }\n\n    render() {\n        return this.state.username\n            ? <ProfileMenu url={this.state.path}\n                username={this.state.username}\n                onLogout={this.handleLogin}\n                onModeChange={this.onModeChange}\n            />\n            : <LoginMenu url={this.state.path}\n                onLogin={this.handleLogin}\n                onModeChange={this.onModeChange}\n            />\n        ;\n    }\n}\n\nclass LoginMenu extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            mode: this.props.url.substr(1),\n        };\n        this.open = this.open.bind(this);\n        this.close = this.close.bind(this);\n        this.toggle = this.toggle.bind(this);\n        this.recover = this.recover.bind(this);\n        this.onLogin = this.onLogin.bind(this);\n        this.resetPassword = this.resetPassword.bind(this);\n    }\n\n    open(mode) {\n        this.setState({\n            mode: mode,\n        });\n    }\n\n    close() {\n        this.setState((prevState) => ({\n            mode: null,\n        }));\n        this.refs.loginDialog.clear();\n    }\n\n    onLogin() {\n        this.close();\n        this.props.onLogin();\n    }\n\n    toggle() {\n        this.setState((prevState, props) => ({\n            mode: prevState.mode === 'signup' ? 'login' : 'signup',\n        }));\n    }\n\n    recover(callback) {\n        this.setState({\n            mode: 'recover',\n        }, callback);\n    }\n\n    resetPassword(callback) {\n        this.setState({\n            mode: 'reset-password',\n        }, callback);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.mode !== this.state.mode) {\n            this.props.onModeChange(this.state.mode);\n        }\n        if (prevProps.url !== this.props.url) {\n            this.setState({\n                mode: this.props.url.substr(1),\n            });\n        }\n    }\n\n    render() {\n        const fontFamily = \"'Concert One', cursive\";\n        return (\n            <div>\n                <div style={{\n                    position: 'fixed',\n                    top: 0, right: 10,\n                    margin: '0 8px',\n                    display: 'flex',\n                    flexDirection: 'row',\n                    zIndex: 3,\n                }}>\n                    <div className=\"button\" onClick={() => this.open('login')} style={{\n                        width: 50, height: 50,\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                    }}>\n                        <div style={{ fontFamily }}>login</div>\n                        <img style={{ width: 32, height: 32 }} src=\"/assets/login.svg\" />\n                    </div>\n                    <div className=\"button\" onClick={() => this.open('signup')} style={{\n                        width: 50, height: 50,\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                    }}>\n                        <div style={{ fontFamily }}>signup</div>\n                        <img style={{ width: 28, height: 28 }} src=\"/assets/signup.svg\" />\n                    </div>\n                </div>\n                <LoginDialog ref=\"loginDialog\"\n                    mode={this.state.mode}\n                    onClickOut={this.close}\n                    toggle={this.toggle}\n                    recover={this.recover}\n                    onLogin={this.onLogin}\n                    resetPassword={this.resetPassword}\n                />\n            </div>\n        );\n    }\n}\n\nclass ProfileMenu extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            view: false,\n            mode: this.props.url.substr(1),\n            updateTime: session.refresh,\n        };\n        this.open = this.open.bind(this);\n        this.close = this.close.bind(this);\n        this.logout = this.logout.bind(this);\n        this.editProfile = this.editProfile.bind(this);\n        this.handleClickOutside = this.handleClickOutside.bind(this);\n        this.profilePicUpdated = this.profilePicUpdated.bind(this);\n        LoginMenu.canUpdateHistory = true;\n    }\n\n    componentDidMount() {\n        document.addEventListener('mousedown', this.handleClickOutside);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('mousedown', this.handleClickOutside);\n    }\n\n    handleClickOutside(event) {\n        let node = event.target;\n        while(node) {\n            if(node===this.refs.wrapper) {\n                return;\n            }\n            node = node.parentNode;\n        }\n        this.close();\n    }\n\n    profile_pic() {\n        return this.state.updateTime\n            ? `/profile-picture/${this.props.username}/thumbnail.png?${this.state.updateTime}`\n            : `/profile-picture/${this.props.username}/thumbnail.png`;\n    }\n\n    profilePicUpdated() {\n        this.setState({\n            updateTime: Date.now(),\n        });\n    }\n\n    open() {\n        this.setState((prevState) => ({\n            view: !prevState.view,\n        }));\n    }\n\n    close() {\n        this.setState((prevState) => ({\n            view: false,\n        }));\n        this.refs.profileDialog.clear();\n    }\n\n    logout() {\n        this.close();\n        api.logout((result) => {\n            session.user = null;\n            this.props.onLogout();\n        });\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.mode !== this.state.mode) {\n            this.props.onModeChange(this.state.mode);\n        }\n        if (prevProps.url !== this.props.url) {\n            this.setState({\n                mode: this.props.url.substr(1),\n            });\n        }\n    }\n\n    editProfile() {\n        this.setState({\n            mode: 'profile',\n            view: false,\n        });\n    }\n\n    render() {\n        const fontFamily = \"'Concert One', cursive\";\n        return (\n            <div ref=\"wrapper\">\n                <div className=\"button\" onClick={this.open} style={{\n                    position: 'fixed',\n                    top: 0, right: 10,\n                    padding: '0 8px',\n                    height: 50,\n                    display: 'flex',\n                    flexDirection: 'row',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    zIndex: 3,\n                }}>\n                    <div style={{\n                        fontFamily,\n                        fontSize: 16,\n                    }}>\n                        { this.props.username }\n                    </div>\n                    <img style={{\n                        width: 40, height: 40, margin: '0 0 0 8px',\n                        borderRadius: 3,\n                    }} src={ this.profile_pic() } />\n                </div>\n                { this.state.view &&\n                    <div style={{\n                        position: 'fixed',\n                        backgroundColor: '#555',\n                        minWidth: 150,\n                        right: 0,\n                        zIndex: 2,\n                    }}>\n                        <div className=\"menu\" onMouseDown={this.editProfile}>\n                            <div>Edit profile</div>\n                        </div>\n                        <div className=\"menu\" onMouseDown={this.logout}>\n                            <div>Log out</div>\n                        </div>\n                    </div>\n                }\n                <ProfileDialog ref=\"profileDialog\"\n                    mode={this.state.mode}\n                    username={this.props.username}\n                    onClickOut={() => {\n                        this.setState({ mode: null });\n                    }}\n                    profilePicUpdated={this.profilePicUpdated}\n                    updateTime={this.state.updateTime}\n                />\n            </div>\n        );\n    }\n}\n\nclass Tip extends React.Component {\n    render() {\n        const fontFamily = \"'Concert One', cursive\";\n        return (<div style={{\n            position: 'fixed',\n            width: '100%',\n            height: 30,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            overflow: 'hidden',\n            zIndex: 2,\n        }}>\n            <div className=\"statetip\" style={{\n                fontFamily,\n                marginTop: this.props.showTip ? 0 : -100,\n                opacity: this.props.showTip ? .95 : 0,\n            }}>\n                {this.props.tip}\n            </div>\n        </div>);\n    }\n}\n\nclass ProfileDialog extends React.Component {\n    constructor(props) {\n        super(props);\n        this.initialState = {\n            cursorOnProfile: 'pointer',\n            profileX: 0,\n            profileY: 0,\n            image: null,\n            saving: false,\n            password: null,\n            password2: null,\n            old_password: null,\n            canChangePassword: false,\n            canSave: false,\n        };\n        this.state = {};\n        for (let k in this.initialState) {\n            this.state[k] = this.initialState[k];\n        }\n        this.state.canChangePassword = this.props.mode==='reset-password';\n\n        this.image = new Image();\n        this.image.addEventListener('load', this.onImageLoaded.bind(this));\n\n        this.profileSection = this.profileSection.bind(this);\n        this.onFileUpload = this.onFileUpload.bind(this);\n        this.onFileRead = this.onFileRead.bind(this);\n        this.onTouchProfile = this.onTouchProfile.bind(this);\n        this.onClickProfile = this.onClickProfile.bind(this);\n        this.onMoveProfile = this.onMoveProfile.bind(this);\n        this.onSave = this.onSave.bind(this);\n        this.profile_pic = this.profile_pic.bind(this);\n        this.passwordChange = this.passwordChange.bind(this);\n        this.password2Change = this.password2Change.bind(this);\n        this.oldPasswordChange = this.oldPasswordChange.bind(this);\n        this.lastMousePoint = { x: 0, y: 0 };\n        this.canUpload = false;\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if(nextProps.mode !== this.state.mode) {\n            this.image = new Image();\n            this.image.addEventListener('load', this.onImageLoaded.bind(this));\n            this.setState({\n                image: null,\n            });\n        }\n    }\n\n    onImageLoaded(e) {\n        const image = e.target;\n        const minSize = Math.min(image.naturalWidth, image.naturalHeight);\n        const scale = 120 / minSize;\n        this.setState({\n            image: image.src,\n            profileX: -(image.naturalWidth * scale - 120) / 2,\n            profileY: -(image.naturalHeight * scale - 120) / 2,\n            canSave: true,\n            imageTooSmall: minSize < 240,\n        });\n    }\n\n    onFileUpload(e) {\n        const uploader = e.target;\n        if (uploader.files && uploader.files[0]) {\n            const reader = new FileReader();\n            reader.addEventListener('load', this.onFileRead);\n            reader.readAsDataURL(uploader.files[0]);\n        }\n    }\n\n    onFileRead(e) {\n        const reader = e.target;\n        this.image.src = reader.result;\n    }\n\n    clear() {\n        this.setState(this.initialState);\n    }\n\n    onClickProfile() {\n        if (this.canUpload) {\n            this.setState({\n                cursorOnProfile: 'pointer',\n            });\n            this.refs.fileupload.click();\n        }\n    }\n\n    onTouchProfile(e) {\n        this.canUpload = true;\n        this.lastMousePoint.x = e.clientX;\n        this.lastMousePoint.y = e.clientY;\n        if (this.image.naturalWidth !== this.image.naturalHeight) {\n            this.setState({\n                cursorOnProfile: this.image.naturalWidth > this.image.naturalHeight ? 'ew-resize' : 'ns-resize',\n            });\n        }\n    }\n\n    onMoveProfile(e) {\n        if(e.buttons && this.image.naturalWidth !== this.image.naturalHeight) {\n            const movementX = this.lastMousePoint.x - e.clientX;\n            const movementY = this.lastMousePoint.y - e.clientY;\n            if (movementX || movementY) {\n                this.canUpload = false;\n                this.setState((prevState) => {\n                    const scale = 240 / Math.min(this.image.naturalWidth, this.image.naturalHeight);\n                    const profileX = Math.min(0, Math.max(\n                        -(this.image.naturalWidth * scale / 2 - 120),\n                        prevState.profileX - movementX\n                    ));\n                    const profileY = Math.min(0, Math.max(\n                        -(this.image.naturalHeight * scale / 2 - 120),\n                        prevState.profileY - movementY\n                    ));\n\n                    return {\n                        profileX, profileY,\n                    };\n                });\n                this.lastMousePoint.x = e.clientX;\n                this.lastMousePoint.y = e.clientY;\n            }\n            e.stopPropagation();\n        }\n    }\n    \n    profilePicBinary() {\n        const canvas = document.createElement('canvas');\n        canvas.width = 240; canvas.height = 240;\n        const ctx = canvas.getContext('2d');\n        const minSize = Math.min(this.image.naturalWidth, this.image.naturalHeight);\n        const scale = minSize / 120;\n        ctx.drawImage(this.image,\n            -this.state.profileX * scale, -this.state.profileY * scale, minSize, minSize,\n            0, 0, 240, 240\n        );\n        return canvas.toDataURL(\"image/png\");\n    }\n\n    onSave() {\n        if (!this.state.loggingIn) {\n            this.setState({\n                saving: true,\n            }, () => {\n                api.save(this.props.username,\n                        this.state.image ? this.profilePicBinary() : null,\n                        this.state.password,\n                        this.state.old_password,\n                        (result) => {\n                    if(result.success) {\n                        this.props.profilePicUpdated();\n                        this.props.onClickOut();\n                    } else {\n                        this.setState({\n                            saving: false,\n                        });\n                    }\n                });\n            });\n        }\n    }\n\n    passwordChange(e) {\n        const target = e.target;\n        this.setState((prevState) => {\n            const invalid = !LoginDialog.validPassword(target.value);\n            const warningMessage = \"Your password must have at least eight characters, including one letter and one number.\";\n            const warning = invalid\n                ? warningMessage\n                : prevState.warning && warningMessage !== prevState.warning\n                ? prevState.warning\n                : null;\n            return {\n                warning,\n                password: target.value,\n                canSave: true,\n            };\n        });\n    }\n\n    password2Change(e) {\n        const target = e.target;\n        this.setState((prevState) => {\n            const invalid = prevState.password !== target.value;\n            const warningMessage = \"The passwords you entered must match.\";\n            const warning = invalid\n                ? warningMessage\n                : prevState.warning && warningMessage !== prevState.warning\n                ? prevState.warning\n                : null;\n            return {\n                warning,\n                password2: target.value,\n                canSave: true,\n            };\n        });\n    }\n\n    oldPasswordChange(e) {\n        const target = e.target;\n        this.setState({\n            old_password: target.value,\n        });\n    }\n\n    profile_pic() {\n        return this.state.image\n            ? this.state.image\n            : this.props.updateTime\n            ? `/profile-picture/${this.props.username}/image.png?${this.props.updateTime}`\n            : `/profile-picture/${this.props.username}/image.png`;\n    }\n\n    profileSection() {\n        const borderRadius = 8;\n        const fontFamily = \"'Concert One', cursive\";\n        return (<div style={{\n            width: '100%',\n            height: 'auto',\n            borderBottomLeftRadius: borderRadius,\n            borderBottomRightRadius: borderRadius,\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n        }}>\n            <div className=\"loginsection\">\n                <div style={{ height: 50 }}/>\n                <div ref=\"profile_pic\" className=\"profile-pic\"\n                 style={{\n                    cursor: this.state.cursorOnProfile,\n                    backgroundImage: `url(${this.profile_pic()})`,\n                    backgroundPositionX: this.state.profileX,\n                    backgroundPositionY: this.state.profileY,\n                 }}\n                 draggable=\"false\"\n                 onMouseMove={this.onMoveProfile}\n                 onMouseDown={this.onTouchProfile}\n                 onClick={this.onClickProfile}>\n                    <img style={{\n                        marginLeft: 100,\n                        position: 'absolute', width: 20, height: 20, zIndex: 1,\n                    }} src=\"/assets/edit.svg\" />\n                </div>\n                {this.state.imageTooSmall &&\n                <div style={{height: 10, margin: 5,\n                    color: '#D00', fontSize: 12}}>\n                    For best result, your image should be at least 240x240\n                </div>\n                }\n                <div style={{\n                    width: 0, height: 0,\n                    overflow: 'hidden',\n                }}>\n                    <input ref=\"fileupload\" onChange={this.onFileUpload} type=\"file\" />\n                </div>\n                <div style={{\n                    fontFamily,\n                    fontSize: 20,\n                }}>{this.props.username}</div>\n\n                {!this.state.canChangePassword ? <div style={{\n                        display: 'flex',\n                        flexDirection: 'row',\n                        height: 40,\n                        width: 160,\n                        marginTop: 20,\n                    }}>\n                        <Button\n                            text=\"Change password\"\n                            leftMost rightMost\n                            fontSize=\"18\"\n                            fontColor=\"#eee\"\n                            background={\"linear-gradient(#59f79d, #2c6846)\"}\n                            backgroundPressed=\"#a3e2bf\"\n                            space=\"true\"\n                            onClick={() => {\n                                this.setState({\n                                    canChangePassword: true,\n                                });\n                            }}\n                        />\n                    </div> :\n                    <div style={{\n                        display: 'flex',\n                        flexDirection: 'column',\n                        width: '70%',\n                        marginTop: 20,\n                        justifyContent: 'center',\n                        alignItems: 'center',\n                    }}>\n                        { this.resetPasswordBox() }\n                    </div>\n                }\n\n                <div style={{\n                    display: 'flex',\n                    marginTop: 20,\n                    alignItems: 'center', alignSelf: 'center', justifyContent: 'center',\n                    width: 50, height: 50,\n                }}>\n                    <div className={\n                        `tux-loading-indicator ${this.state.saving?'show':''}`\n                    }>\n                    </div>\n                </div>\n                <hr/>\n                <div style={{\n                    display: 'flex',\n                    flexDirection: 'row',\n                    height: 50,\n                    width: '70%',\n                    margin: '20px 0',\n                }}>\n                    <Button\n                        text=\"Save\"\n                        leftMost rightMost\n                        fontSize=\"24\"\n                        fontColor=\"#eee\"\n                        background={\"linear-gradient(#59f79d, #2c6846)\"}\n                        backgroundPressed=\"#a3e2bf\"\n                        space=\"true\"\n                        onClick={this.onSave}\n                        disabled={!this.state.canSave}\n                    />\n                    <Button\n                        text=\"Cancel\"\n                        leftMost rightMost\n                        fontSize=\"24\"\n                        fontColor=\"#eee\"\n                        background={\"linear-gradient(#f7599d, #682c46)\"}\n                        backgroundPressed=\"#e2bfa3\"\n                        space=\"true\"\n                        onClick={this.props.onClickOut}\n                    />\n                </div>\n            </div>\n        </div>);\n    }\n\n    resetPasswordBox() {\n        const fontFamily = \"'Concert One', cursive\";\n        return [\n            <div style={{ fontFamily, marginBottom: 5 }}>Old password</div>,\n            <input ref=\"old_password_field\"\n                   type=\"password\"\n                   placeholder=\"Enter your old password\"\n                   className=\"input\"\n                   onChange={this.oldPasswordChange.bind(this)}\n                   value={this.state.old_password}\n                   onKeyPress={(event) => {\n                       if(event.key === 'Enter'){\n                           this.refs.password_field.focus();\n                       }\n                   }}\n                   style={{\n                       height: 40,\n                       width: '100%',\n                   }}/>,\n            <div style={{ height: 20 }}/>,\n            <div style={{ fontFamily, marginBottom: 5 }}>New password</div>,\n            <input ref=\"password_field\"\n                   type=\"password\"\n                   placeholder=\"Enter a new password\"\n                   className=\"input\"\n                   onChange={this.passwordChange.bind(this)}\n                   disabled={this.state.loggingIn}\n                   value={this.state.password}\n                   onKeyPress={(event) => {\n                       if(event.key === 'Enter'){\n                           this.refs.password_field2.focus();\n                       }\n                   }}\n                   style={{\n                       height: 40,\n                       width: '100%',\n                   }}/>,\n            <div style={{ height: 10 }}/>,\n            <input ref=\"password_field2\"\n                   type=\"password\"\n                   placeholder=\"Re-enter the same password\"\n                   className=\"input\"\n                   onChange={this.password2Change.bind(this)}\n                   disabled={this.state.loggingIn}\n                   value={this.state.password2}\n                   onKeyPress={(event) => {\n                       if (event.key === 'Enter') {\n                           event.target.blur();\n                       }\n                   }}\n                   style={{\n                       height: 40,\n                       width: '100%',\n                   }}/>,\n            <div style={{ height: 20 }}/>,\n            <div style={{\n                color: '#D00',\n                marginTop: 15,\n            }}>{this.state.warning}</div>,\n        ];\n    }\n\n    render() {\n        return (\n            <div>\n                <Overlay mode={this.props.mode}>\n                    { this.props.mode &&\n                    <div className=\"overlay\">\n                        <div style={{\n                            position: 'fixed',\n                            top: 0, left: 0,\n                            width: '100%', height: 'calc(100% + 200px)',\n                            transition: 'opacity .2s linear',\n                            opacity: this.props.mode ? .8: 0,\n                            backgroundColor: '#046',\n                            cursor: 'pointer',\n                            display: this.props.mode ? '' : 'none',\n                        }} onClick={this.props.onClickOut}>\n                        </div>\n                        <div className=\"popdialog\" style={{\n                            width: 600, height: 'auto',\n                        }}>\n                            <div style={{ width: '100%', overflow: 'hidden' }}>\n                                { this.profileSection() }\n                            </div>\n                        </div>\n                    </div>\n                    }\n                </Overlay>\n            </div>\n        );\n    }\n}"]}